<HTML><HEAD><TITLE>AFNI & FSL</TITLE></HEAD>
<BODY BACKGROUND="../images/fsl-bg.jpg">
<hr><TABLE BORDER=0 WIDTH="100%"><TR>
<TD ALIGN=LEFT><a href="http://afni.nimh.nih.gov/afni/"><IMG BORDER=0 SRC="afnilogo.gif"></a>
<TD ALIGN=CENTER><H1>AFNI & FSL<br>Interoperation</H1>
<TD ALIGN=RIGHT><a href="../index.html"><IMG BORDER=0 SRC="../images/fsl-logo.jpg"></a>
</TR></TABLE><hr>

<p><a href="http://afni.nimh.nih.gov/afni/">AFNI</a> is a set of C
programs for processing, analyzing, and displaying FMRI data. It runs
on Unix+X11+Motif systems, including SGI, Solaris, Linux, and Mac OS
X. It is available free (in C source code format, and some precompiled
binaries) for research purposes.

<p>One of AFNI's particular strengths is that it is a powerful display
tool. Bob Cox has very kindly made some changes in AFNI which make it
very easy to view FSL output, in particular, FEAT output, using
AFNI. You can easily:

<UL>

<LI>View thresholded or unthresholded FEAT stats images,
colour-overlaid onto lowres (example_func.hdr), structural
(highres.hdr) or standard-space (standard.hdr) images, without having
to transform the stats images, because AFNI understands the
registration transforms saved in the FEAT directory.

<LI>View thresholded or unthresholded FEAT stats images,
colour-overlaid onto the filtered 4D data (filtered_func_data.hdr),
and view time series by clicking on the coloured stats
overlays.

</UL>

<p>To get this working, download</a> and install the latest version of
AFNI. Then:

<UL>

<LI><b>feat2afni &lt;featdirectory.feat&gt;</b> (this is a short
script necessary for FEAT5 analyses which makes links to certain files
in the FEAT directory for AFNI to use - it will probably not be
necessary once we have finished working with Bob Cox on the
interoperation of AFNI and FSL).

<BR><BR><LI><b>cd &lt;featdirectory.feat&gt;<br>afni</b>

<BR><BR><LI>Load in an <b>Anatomy</b> image (eg <b>example_func.hdr</b>) by
pressing <b>Switch Anatomy</b> (don't select by double-clicking;
click once then press
<b>Set</b>). Press one or more <b>Image</b> buttons.

<BR><BR><LI>To view voxel intensity at the crosshair, you have to open all
<b>Image</b> views and have the <b>Define function</b> view open. Then
the value is displayed.

<BR><BR><LI>Load in a stats image (eg <b>thresh_zstat1.hdr</b>) by
pressing <b>Switch Function</b>. Press <b>See Function</b>.

<BR><BR><LI>To make the colour overlay transparent press the down-arrow next to
the <b>9</b> on an image viewer.

<BR><BR><LI>To view stats overlaid on either highres or standard press
<b>Switch Anatomy</b> and select the apropriate image.

<BR><BR><LI>To view time series, load in <b>filtered_func_data.hdr</b> using
<b>Switch Anatomy</b> and press one or more <b>Graph</b> buttons.

<BR><BR><LI>To view a histogram of the current anatomical image, press
<b>Define Datamode -&gt; Plugins -&gt; Histogram</b>. 

<BR><BR><LI>If you create a new image in a directory after starting afni, to
get afni to realise it's there, you must press <b>Define Datamode
-&gt; Rescan -&gt; This</b>.

<BR><BR><LI>To create an image mask using AFNI: Load in an anatomical image by
pressing <b>Switch Anatomy</b>. Press all three <b>Image</b> buttons.
Press <b>Define Datamode -&gt; Plugins -&gt; Draw Dataset</b>.  Press
<b>Choose Dataset</b> and select your anatomical image.  Set the
<b>Drawing Value</b> to a value greater than the maximum value in your
image.  Set <b>Drawing Mode</b> to Filled Curve.  Draw on any of the
three Images using the middle mouse button.  To undo the previous
drawing click <b>Undo</b> in the AFNI Editor window (you can only undo
one previous fill).  Save the mask by clicking <b>Save As</b> in the
AFNI Editor window (suppose you choose <b>grot</b>; your file will get
saved as <b>grot+orig.BRIK</b>).  To convert your mask from afni to
analyse format run <b>afni2avw grot+orig</b> from the command line.
To remove the background brain image and binarise your mask run
<br><b>avwmaths grot+orig -thr &lt;val&gt; -bin grot+orig</b> from the
command line, where the threshold value used is just below the value
you filled the mask with.

</UL>

<p><HR><FONT SIZE=1>Written by <A HREF="http://www.fmrib.ox.ac.uk/~steve/index.html">S. Smith</A></FONT>

</BODY></HTML>

